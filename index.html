<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anoma Academy - Learn, Play, Master</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --surface: #1a1a1a;
            --text: #ffffff;
            --muted: #888888;
            --accent: #00d4ff;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .main-title {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        .main-subtitle {
            font-size: 1.2rem;
            color: var(--muted);
            margin-bottom: 30px;
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .btn {
            background: linear-gradient(135deg, var(--accent), var(--success));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-label {
            color: var(--muted);
            font-size: 0.9rem;
        }

        .learning-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .lesson-card {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lesson-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .lesson-card.unlocked {
            border-color: var(--success);
        }

        .lesson-card h4 {
            color: var(--accent);
            margin-bottom: 10px;
        }

        .cost {
            color: var(--success);
            font-weight: bold;
            margin-top: 10px;
        }

        .game-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .game-card h4 {
            color: var(--accent);
            margin-bottom: 10px;
        }

        .social-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .social-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .social-btn:hover {
            background: var(--accent);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background: var(--surface);
            margin: 5% auto;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            position: relative;
        }

        .close-btn {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: var(--muted);
        }

        .close-btn:hover {
            color: var(--text);
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .toast.show {
            opacity: 1;
        }

        .toast.success { background: var(--success); }
        .toast.error { background: var(--danger); }
        .toast.info { background: var(--accent); }
        .toast.warning { background: var(--warning); }

        @media (max-width: 768px) {
            .main-title { font-size: 2rem; }
            .learning-section, .game-section { grid-template-columns: 1fr; }
            .social-links { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="main-title">üèõÔ∏è Anoma Academy</h1>
            <p class="main-subtitle">Learn Anoma Concepts ‚Üí Earn Points ‚Üí Play Games ‚Üí Master Web3</p>
        </div>

        <!-- Player Stats -->
        <div class="card">
            <h3>üìä Your Progress</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div id="points" class="stat-value">1000</div>
                    <div class="stat-label">Points</div>
                </div>
                <div class="stat-item">
                    <div id="level" class="stat-value">1</div>
                    <div class="stat-label">Level</div>
                </div>
                <div class="stat-item">
                    <div id="lessons-completed" class="stat-value">0/6</div>
                    <div class="stat-label">Lessons</div>
                </div>
                <div class="stat-item">
                    <div id="games-played" class="stat-value">0</div>
                    <div class="stat-label">Games Played</div>
                </div>
            </div>
        </div>

        <!-- Learning Section -->
        <div class="card">
            <h3>üéì Learn Anoma Concepts</h3>
            <p style="color: var(--muted); margin-bottom: 20px;">
                Complete lessons to earn points and unlock games. Each lesson teaches you about Anoma's core concepts.
            </p>
            <div class="learning-section">
                <div class="lesson-card unlocked" onclick="startLesson(1)">
                    <h4>üå± What is Anoma?</h4>
                    <p>Learn the basics of intent-centric blockchain</p>
                    <div class="cost">Reward: 50 points</div>
                </div>
                <div class="lesson-card" onclick="startLesson(2)">
                    <h4>‚ö° Intent System</h4>
                    <p>Understand how intents work in Anoma</p>
                    <div class="cost">Reward: 50 points</div>
                </div>
                <div class="lesson-card" onclick="startLesson(3)">
                    <h4>üîê Privacy & ZK</h4>
                    <p>Learn about zero-knowledge proofs</p>
                    <div class="cost">Reward: 50 points</div>
                </div>
                <div class="lesson-card" onclick="startLesson(4)">
                    <h4>üåê Cross-Chain</h4>
                    <p>Understand cross-chain operations</p>
                    <div class="cost">Reward: 50 points</div>
                </div>
                <div class="lesson-card" onclick="startLesson(5)">
                    <h4>üéØ Advanced Intents</h4>
                    <p>Master complex intent strategies</p>
                    <div class="cost">Reward: 50 points</div>
                </div>
                <div class="lesson-card" onclick="startLesson(6)">
                    <h4>üèÜ Anoma Master</h4>
                    <p>Become an Anoma expert</p>
                    <div class="cost">Reward: 100 points</div>
                </div>
            </div>
        </div>

        <!-- Game Section -->
        <div class="card">
            <h3>üéÆ Play Games with Your Points</h3>
            <p style="color: var(--muted); margin-bottom: 20px;">
                Use your earned points to play games that teach you more about Anoma concepts.
            </p>
            <div class="game-section">
                <div class="game-card">
                    <h4>üéØ Intent Matching Game</h4>
                    <p>Match intents with their optimal execution paths</p>
                    <div class="cost">Cost: 20 points</div>
                    <button class="btn" onclick="playIntentGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üîê Privacy Puzzle</h4>
                    <p>Solve puzzles using zero-knowledge concepts</p>
                    <div class="cost">Cost: 30 points</div>
                    <button class="btn" onclick="playPrivacyGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üåê Cross-Chain Challenge</h4>
                    <p>Navigate assets across different blockchains</p>
                    <div class="cost">Cost: 40 points</div>
                    <button class="btn" onclick="playCrossChainGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>‚ö° Speed Intent</h4>
                    <p>Express intents as fast as possible</p>
                    <div class="cost">Cost: 25 points</div>
                    <button class="btn" onclick="playSpeedGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üîç Intent Detective</h4>
                    <p>Analyze complex intents and find the best path</p>
                    <div class="cost">Cost: 35 points</div>
                    <button class="btn" onclick="playDetectiveGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üõ°Ô∏è Privacy Guardian</h4>
                    <p>Protect user data using ZK proofs</p>
                    <div class="cost">Cost: 30 points</div>
                    <button class="btn" onclick="playGuardianGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üåâ Bridge Master</h4>
                    <p>Connect different blockchains efficiently</p>
                    <div class="cost">Cost: 40 points</div>
                    <button class="btn" onclick="playBridgeGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üéØ Intent Builder</h4>
                    <p>Create complex multi-step intents</p>
                    <div class="cost">Cost: 50 points</div>
                    <button class="btn" onclick="playBuilderGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üéÆ Intent Tower Defense</h4>
                    <p>Defend against attacks using Anoma tools</p>
                    <div class="cost">Cost: 60 points</div>
                    <button class="btn" onclick="playTowerDefense()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üß© Privacy Puzzle (Visual)</h4>
                    <p>Drag and drop ZK proof components</p>
                    <div class="cost">Cost: 35 points</div>
                    <button class="btn" onclick="playPuzzleGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üèÉ Intent Runner</h4>
                    <p>Jump and collect intent pieces</p>
                    <div class="cost">Cost: 30 points</div>
                    <button class="btn" onclick="playRunnerGame()">Play Game</button>
                </div>
                <div class="game-card">
                    <h4>üé≤ Intent Dice</h4>
                    <p>Roll dice to build intent combinations</p>
                    <div class="cost">Cost: 25 points</div>
                    <button class="btn" onclick="playDiceGame()">Play Game</button>
                </div>
                <div class="game-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: 2px dashed var(--accent);">
                    <h4>üöÄ More Games</h4>
                    <p>Coming Soon...</p>
                    <div class="cost" style="color: var(--accent);">Êï¨ËØ∑ÊúüÂæÖ</div>
                    <button class="btn" onclick="showComingSoon()" style="background: var(--accent);">Êï¨ËØ∑ÊúüÂæÖ</button>
                </div>
            </div>
        </div>

        <!-- Social Links -->
        <div class="card">
            <h3>üì± Follow Anoma</h3>
            <p style="color: var(--muted); margin-bottom: 20px;">
                Stay updated with the latest Anoma developments and join the community!
            </p>
            <div class="social-links">
                <a href="https://twitter.com/anomanetwork" target="_blank" class="social-btn">
                    <span>üê¶</span> Follow @anomanetwork
                </a>
                <a href="https://twitter.com/251262871Com" target="_blank" class="social-btn">
                    <span>üë®‚Äçüíª</span> Follow @251262871Com
                </a>
                <a href="https://discord.gg/anoma" target="_blank" class="social-btn">
                    <span>üí¨</span> Join Discord
                </a>
                <a href="https://github.com/anoma" target="_blank" class="social-btn">
                    <span>üíª</span> View Code
                </a>
                <a href="https://anoma.network" target="_blank" class="social-btn">
                    <span>üåê</span> Visit Website
                </a>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast" class="toast"></div>

    <script>
        // Game State
        let gameState = {
            points: 1000,
            level: 1,
            lessonsCompleted: 0,
            gamesPlayed: 0,
            completedLessons: [],
            achievements: []
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            showToast('üèõÔ∏è Welcome to Anoma Academy! Start learning to earn points!', 'info');
        });

        // Update stats
        function updateStats() {
            document.getElementById('points').textContent = gameState.points;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('lessons-completed').textContent = `${gameState.lessonsCompleted}/6`;
            document.getElementById('games-played').textContent = gameState.gamesPlayed;
        }

        // Start lesson
        function startLesson(lessonNumber) {
            if (gameState.completedLessons.includes(lessonNumber)) {
                showToast('You already completed this lesson!', 'error');
                return;
            }

            if (lessonNumber > 1 && !gameState.completedLessons.includes(lessonNumber - 1)) {
                showToast('Complete the previous lesson first!', 'error');
                return;
            }

            showLessonModal(lessonNumber);
        }

        // Show lesson modal
        function showLessonModal(lessonNumber) {
            const lessons = {
                1: {
                    title: "üå± What is Anoma?",
                    content: `
                        <h3>What is Anoma?</h3>
                        <p>Anoma is a revolutionary blockchain protocol that introduces <strong>intent-centric interactions</strong>.</p>
                        <p>Instead of telling the system HOW to do something, you tell it WHAT you want to achieve.</p>
                        <br>
                        <h4>Key Concepts:</h4>
                        <ul>
                            <li><strong>Intent System:</strong> Express what you want, not how to do it</li>
                            <li><strong>Privacy First:</strong> Zero-knowledge proofs protect your data</li>
                            <li><strong>Cross-Chain:</strong> Works across multiple blockchains</li>
                            <li><strong>AI-Powered:</strong> Smart matching finds the best execution path</li>
                        </ul>
                        <br>
                        <h4>Example:</h4>
                        <p>Instead of: "Execute ETH/USDC swap on Uniswap V3"</p>
                        <p>You say: "I want to swap 1 ETH for the best possible amount of USDC"</p>
                    `
                },
                2: {
                    title: "‚ö° Intent System",
                    content: `
                        <h3>How Intents Work</h3>
                        <p>Anoma's intent system processes your requests in three steps:</p>
                        <br>
                        <h4>1. Express Intent</h4>
                        <p>Tell the system what you want to achieve</p>
                        <br>
                        <h4>2. AI Analysis</h4>
                        <p>The system finds the best execution path across all available options</p>
                        <br>
                        <h4>3. Execute</h4>
                        <p>Your intent is automatically executed with optimal results</p>
                    `
                },
                3: {
                    title: "üîê Privacy & ZK",
                    content: `
                        <h3>Zero-Knowledge Proofs</h3>
                        <p>Anoma uses zero-knowledge proofs to protect your privacy while maintaining security.</p>
                        <br>
                        <h4>How it works:</h4>
                        <ul>
                            <li>Prove you have the right to do something</li>
                            <li>Without revealing what that something is</li>
                            <li>Maintain complete privacy</li>
                        </ul>
                    `
                },
                4: {
                    title: "üåê Cross-Chain",
                    content: `
                        <h3>Cross-Chain Operations</h3>
                        <p>Anoma works across multiple blockchains seamlessly.</p>
                        <br>
                        <h4>Benefits:</h4>
                        <ul>
                            <li>Access to all blockchain ecosystems</li>
                            <li>Best execution across chains</li>
                            <li>Unified experience</li>
                        </ul>
                    `
                },
                5: {
                    title: "üéØ Advanced Intents",
                    content: `
                        <h3>Complex Intent Strategies</h3>
                        <p>Learn to create sophisticated multi-step intents.</p>
                        <br>
                        <h4>Advanced Features:</h4>
                        <ul>
                            <li>Multi-step transactions</li>
                            <li>Conditional logic</li>
                            <li>Cross-chain arbitrage</li>
                        </ul>
                    `
                },
                6: {
                    title: "üèÜ Anoma Master",
                    content: `
                        <h3>Congratulations!</h3>
                        <p>You've mastered the core concepts of Anoma!</p>
                        <br>
                        <h4>You now understand:</h4>
                        <ul>
                            <li>Intent-centric interactions</li>
                            <li>Privacy protection with ZK</li>
                            <li>Cross-chain operations</li>
                            <li>Advanced strategies</li>
                        </ul>
                    `
                }
            };

            const lesson = lessons[lessonNumber];
            if (!lesson) return;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>${lesson.title}</h3>
                    <div style="margin: 20px 0; line-height: 1.8;">
                        ${lesson.content}
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn" onclick="completeLesson(${lessonNumber})">Complete Lesson</button>
                        <button class="btn" onclick="closeModal()" style="background: var(--muted);">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Complete lesson
        function completeLesson(lessonNumber) {
            if (!gameState.completedLessons.includes(lessonNumber)) {
                gameState.completedLessons.push(lessonNumber);
                gameState.lessonsCompleted++;
                gameState.points += lessonNumber === 6 ? 100 : 50;
                gameState.level = Math.floor(gameState.lessonsCompleted / 2) + 1;
                
                updateStats();
                showToast(`Lesson ${lessonNumber} completed! +${lessonNumber === 6 ? 100 : 50} points`, 'success');
                
                // Unlock next lesson
                if (lessonNumber < 6) {
                    const nextLesson = document.querySelector(`[onclick="startLesson(${lessonNumber + 1})"]`);
                    if (nextLesson) {
                        nextLesson.classList.add('unlocked');
                    }
                }
            }
            closeModal();
        }

        // Game functions
        function playIntentGame() {
            if (gameState.points < 20) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 20;
            gameState.gamesPlayed++;
            updateStats();
            showIntentGame();
        }

        function showIntentGame() {
            const questions = [
                {
                    question: "I want to swap 1 ETH for USDC with the best rate",
                    options: ["Use Uniswap V3", "Use 1inch aggregator", "Use Anoma intent system", "Use centralized exchange"],
                    correct: 2,
                    explanation: "Anoma's intent system finds the best execution path across all DEXs automatically"
                },
                {
                    question: "I want to vote on a governance proposal privately",
                    options: ["Use public voting", "Use zero-knowledge proof", "Use email verification", "Skip voting"],
                    correct: 1,
                    explanation: "ZK proofs allow you to prove you voted without revealing your choice"
                },
                {
                    question: "I want to bridge assets from Ethereum to Polygon",
                    options: ["Use Anoma cross-chain intent", "Use separate bridge contracts", "Use centralized exchange", "Not possible"],
                    correct: 0,
                    explanation: "Anoma handles cross-chain operations seamlessly through intents"
                }
            ];

            let currentQuestion = 0;
            let score = 0;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üéØ Intent Matching Game</h3>
                    <div id="intent-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Question ${currentQuestion + 1}/3</h4>
                            <div style="font-size: 1.2rem; margin: 20px 0; padding: 20px; background: var(--bg); border-radius: 10px;">
                                <strong>${questions[0].question}</strong>
                            </div>
                            <div id="intent-options" style="display: grid; gap: 10px; margin: 20px 0;">
                                ${questions[0].options.map((option, index) => 
                                    `<button class="btn" onclick="selectIntentOption(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${option}</button>`
                                ).join('')}
                            </div>
                            <div id="intent-score">Score: 0/3</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            window.selectIntentOption = function(selectedIndex) {
                const correct = questions[currentQuestion].correct;
                if (selectedIndex === correct) {
                    score++;
                    showToast('‚úÖ Correct!', 'success');
                } else {
                    showToast('‚ùå Wrong!', 'error');
                }

                currentQuestion++;
                if (currentQuestion < questions.length) {
                    document.querySelector('h4').textContent = `Question ${currentQuestion + 1}/3`;
                    document.querySelector('#intent-game-content strong').textContent = questions[currentQuestion].question;
                    document.getElementById('intent-options').innerHTML = questions[currentQuestion].options.map((option, index) => 
                        `<button class="btn" onclick="selectIntentOption(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${option}</button>`
                    ).join('');
                    document.getElementById('intent-score').textContent = `Score: ${score}/${currentQuestion}`;
                } else {
                    // Game finished
                    const finalScore = score;
                    const pointsEarned = Math.floor(finalScore * 10);
                    gameState.points += pointsEarned;
                    updateStats();
                    
                    document.getElementById('intent-game-content').innerHTML = `
                        <div style="text-align: center;">
                            <h3>üéâ Game Complete!</h3>
                            <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}/3</div>
                            <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                            <button class="btn" onclick="closeModal()">Close</button>
                        </div>
                    `;
                }
            };
        }

        function playPrivacyGame() {
            if (gameState.points < 30) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 30;
            gameState.gamesPlayed++;
            updateStats();
            showPrivacyGame();
        }

        function showPrivacyGame() {
            const puzzles = [
                {
                    title: "ZK Proof Puzzle",
                    description: "Arrange the pieces to show how ZK proofs work",
                    pieces: ["Secret", "Proof", "Verifier", "Prover", "Public", "Private"],
                    solution: ["Prover", "Secret", "Proof", "Verifier", "Public", "Private"],
                    explanation: "Prover uses Secret to create Proof, Verifier checks Proof against Public info, keeping Private data hidden"
                },
                {
                    title: "Intent Flow Puzzle",
                    description: "Order the steps of intent execution",
                    pieces: ["Express Intent", "Find Solver", "Execute", "Verify", "Settle"],
                    solution: ["Express Intent", "Find Solver", "Execute", "Verify", "Settle"],
                    explanation: "User expresses intent ‚Üí System finds solver ‚Üí Solver executes ‚Üí Results verified ‚Üí Transaction settled"
                }
            ];

            let currentPuzzle = 0;
            let score = 0;
            let selectedPieces = [];
            let placedPieces = [];

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üß© Privacy Puzzle Game</h3>
                    <div id="puzzle-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>${puzzles[0].title}</h4>
                            <p>${puzzles[0].description}</p>
                            <div id="puzzle-board" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; min-height: 200px;">
                                ${puzzles[0].pieces.map((piece, index) => 
                                    `<div class="puzzle-piece" onclick="selectPuzzlePiece(${index})" style="background: var(--surface); border: 2px solid var(--border); border-radius: 8px; padding: 15px; text-align: center; cursor: pointer; transition: all 0.3s ease;">${piece}</div>`
                                ).join('')}
                            </div>
                            <div id="puzzle-solution" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; min-height: 200px; background: rgba(0, 212, 255, 0.1); border-radius: 10px; padding: 20px;">
                                <div style="grid-column: 1/-1; text-align: center; color: var(--muted);">Drop pieces here in correct order</div>
                            </div>
                            <button class="btn" onclick="checkPuzzle()" style="background: var(--success);">Check Solution</button>
                            <div id="puzzle-score">Score: 0/2</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            window.selectPuzzlePiece = function(index) {
                if (selectedPieces.includes(index)) return;
                
                selectedPieces.push(index);
                const piece = puzzles[currentPuzzle].pieces[index];
                placedPieces.push(piece);
                
                updatePuzzleDisplay();
            };

            window.checkPuzzle = function() {
                const solution = puzzles[currentPuzzle].solution;
                const isCorrect = JSON.stringify(placedPieces) === JSON.stringify(solution);
                
                if (isCorrect) {
                    score++;
                    showToast('‚úÖ Puzzle solved!', 'success');
                    
                    document.getElementById('puzzle-solution').innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center;">
                            <h4>Correct! üéâ</h4>
                            <p>${puzzles[currentPuzzle].explanation}</p>
                        </div>
                    `;
                    
                    setTimeout(() => {
                        currentPuzzle++;
                        if (currentPuzzle < puzzles.length) {
                            loadPuzzle(currentPuzzle);
                        } else {
                            endPuzzleGame();
                        }
                    }, 2000);
                } else {
                    showToast('‚ùå Try again!', 'error');
                    selectedPieces = [];
                    placedPieces = [];
                    loadPuzzle(currentPuzzle);
                }
            };

            function loadPuzzle(index) {
                selectedPieces = [];
                placedPieces = [];
                
                document.querySelector('h4').textContent = puzzles[index].title;
                document.querySelector('p').textContent = puzzles[index].description;
                
                document.getElementById('puzzle-board').innerHTML = puzzles[index].pieces.map((piece, i) => 
                    `<div class="puzzle-piece" onclick="selectPuzzlePiece(${i})" style="background: var(--surface); border: 2px solid var(--border); border-radius: 8px; padding: 15px; text-align: center; cursor: pointer; transition: all 0.3s ease;">${piece}</div>`
                ).join('');
                
                document.getElementById('puzzle-solution').innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: var(--muted);">Drop pieces here in correct order</div>';
            }

            function updatePuzzleDisplay() {
                document.getElementById('puzzle-solution').innerHTML = placedPieces.map(piece => 
                    `<div style="background: var(--accent); color: white; border-radius: 8px; padding: 15px; text-align: center;">${piece}</div>`
                ).join('');
            }

            function endPuzzleGame() {
                const pointsEarned = Math.floor(score * 15);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('puzzle-game-content').innerHTML = `
                    <div style="text-align: center;">
                        <h3>üéâ All Puzzles Solved!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${score}/2</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                        <button class="btn" onclick="closeModal()">Close</button>
                    </div>
                `;
            }
        }

        function playCrossChainGame() {
            if (gameState.points < 40) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 40;
            gameState.gamesPlayed++;
            updateStats();
            showCrossChainGame();
        }

        function showCrossChainGame() {
            const bridges = [
                { from: 'Ethereum', to: 'Polygon', method: 'Polygon Bridge', cost: 0.1, time: 10 },
                { from: 'Ethereum', to: 'Arbitrum', method: 'Arbitrum Bridge', cost: 0.05, time: 5 },
                { from: 'Polygon', to: 'Arbitrum', method: 'Hop Protocol', cost: 0.02, time: 3 },
                { from: 'Arbitrum', to: 'Optimism', method: 'Synapse Protocol', cost: 0.03, time: 4 },
                { from: 'Ethereum', to: 'BSC', method: 'Binance Bridge', cost: 0.08, time: 8 }
            ];

            let currentBridge = 0;
            let score = 0;
            let timeLeft = 60;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üåâ Bridge Master Game</h3>
                    <div id="bridge-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Connect different blockchains efficiently</h4>
                            <div style="font-size: 1.2rem; margin: 20px 0; color: var(--warning);">
                                Time Left: <span id="bridge-time-left">${timeLeft}</span>s
                            </div>
                            <div style="font-size: 1.2rem; margin: 20px 0; padding: 20px; background: var(--bg); border-radius: 10px;">
                                <strong>Bridge from ${bridges[0].from} to ${bridges[0].to}</strong>
                            </div>
                            <div id="bridge-options" style="display: grid; gap: 10px; margin: 20px 0;">
                                ${bridges.map((bridge, index) => 
                                    `<button class="btn" onclick="selectBridge(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${bridge.method} (${bridge.cost} ETH, ${bridge.time}min)</button>`
                                ).join('')}
                            </div>
                            <div id="bridge-score">Score: 0</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Timer
            const timer = setInterval(() => {
                timeLeft--;
                document.getElementById('bridge-time-left').textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    endBridgeGame(score);
                }
            }, 1000);

            window.selectBridge = function(bridgeIndex) {
                const selectedBridge = bridges[bridgeIndex];
                const currentTarget = bridges[currentBridge];
                
                if (selectedBridge.from === currentTarget.from && selectedBridge.to === currentTarget.to) {
                    score++;
                    currentBridge = (currentBridge + 1) % bridges.length;
                    document.querySelector('#bridge-game-content strong').textContent = `Bridge from ${bridges[currentBridge].from} to ${bridges[currentBridge].to}`;
                    document.getElementById('bridge-score').textContent = `Score: ${score}`;
                    showToast('‚úÖ Correct bridge!', 'success');
                } else {
                    showToast('‚ùå Wrong bridge!', 'error');
                }
            };

            function endBridgeGame(finalScore) {
                clearInterval(timer);
                const pointsEarned = Math.floor(finalScore * 25);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('bridge-game-content').innerHTML = `
                    <div style="text-align: center;">
                        <h3>üéâ Game Complete!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                        <button class="btn" onclick="closeModal()">Close</button>
                    </div>
                `;
            }
        }

        function playSpeedGame() {
            if (gameState.points < 25) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 25;
            gameState.gamesPlayed++;
            updateStats();
            showSpeedGame();
        }

        function showSpeedGame() {
            const intents = [
                "Swap 1 ETH for USDC",
                "Bridge 100 USDC to Polygon",
                "Stake 10 ATOM for rewards",
                "Vote on governance proposal",
                "Provide liquidity to Uniswap",
                "Claim airdrop tokens",
                "Execute limit order",
                "Compound staking rewards"
            ];

            let currentIntent = 0;
            let score = 0;
            let timeLeft = 30;
            let gameRunning = false;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>‚ö° Speed Intent Game</h3>
                    <div id="speed-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Express intents as fast as possible!</h4>
                            <div style="font-size: 1.2rem; margin: 20px 0; color: var(--warning);">
                                Time Left: <span id="speed-time-left">${timeLeft}</span>s
                            </div>
                            <div style="font-size: 1.5rem; margin: 20px 0; padding: 20px; background: var(--bg); border-radius: 10px; min-height: 60px;">
                                <strong id="current-intent">${intents[0]}</strong>
                            </div>
                            <div style="margin: 20px 0;">
                                <button class="btn" onclick="startSpeedGame()" id="start-speed-btn">Start Game</button>
                                <button class="btn" onclick="nextIntent()" id="next-intent-btn" disabled>Next Intent</button>
                            </div>
                            <div id="speed-score">Score: 0</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            function startSpeedGame() {
                gameRunning = true;
                document.getElementById('start-speed-btn').disabled = true;
                document.getElementById('next-intent-btn').disabled = false;
                
                // Timer
                const timer = setInterval(() => {
                    timeLeft--;
                    document.getElementById('speed-time-left').textContent = timeLeft;
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        endSpeedGame(score);
                    }
                }, 1000);
            }

            window.nextIntent = function() {
                if (!gameRunning) return;
                
                score++;
                currentIntent = (currentIntent + 1) % intents.length;
                document.getElementById('current-intent').textContent = intents[currentIntent];
                document.getElementById('speed-score').textContent = `Score: ${score}`;
                showToast('Intent expressed!', 'success');
            };

            function endSpeedGame(finalScore) {
                gameRunning = false;
                const pointsEarned = Math.floor(finalScore * 5);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('speed-game-content').innerHTML = `
                    <div style="text-align: center;">
                        <h3>üéâ Game Complete!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                        <button class="btn" onclick="closeModal()">Close</button>
                    </div>
                `;
            }
        }

        function playDetectiveGame() {
            if (gameState.points < 35) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 35;
            gameState.gamesPlayed++;
            updateStats();
            showDetectiveGame();
        }

        function showDetectiveGame() {
            const cases = [
                {
                    scenario: "User wants to swap 1 ETH for USDC but gas fees are too high",
                    options: [
                        "Wait for lower gas fees",
                        "Use Anoma intent system to find optimal path",
                        "Use centralized exchange",
                        "Skip the transaction"
                    ],
                    correct: 1,
                    explanation: "Anoma's intent system finds the most cost-effective execution path across all available options"
                },
                {
                    scenario: "User needs to vote on governance but wants to keep their choice private",
                    options: [
                        "Vote publicly",
                        "Use zero-knowledge proof voting",
                        "Skip voting",
                        "Use email verification"
                    ],
                    correct: 1,
                    explanation: "ZK proofs allow proving you voted without revealing your choice"
                },
                {
                    scenario: "User wants to bridge assets from Ethereum to Polygon with minimal slippage",
                    options: [
                        "Use direct bridge contract",
                        "Use Anoma cross-chain intent",
                        "Use centralized exchange",
                        "Wait for better rates"
                    ],
                    correct: 1,
                    explanation: "Anoma's cross-chain intents find the best bridge with optimal execution"
                }
            ];

            let currentCase = 0;
            let score = 0;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üîç Intent Detective Game</h3>
                    <div id="detective-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Case ${currentCase + 1}/3</h4>
                            <div style="font-size: 1.2rem; margin: 20px 0; padding: 20px; background: var(--bg); border-radius: 10px;">
                                <strong>${cases[0].scenario}</strong>
                            </div>
                            <div id="detective-options" style="display: grid; gap: 10px; margin: 20px 0;">
                                ${cases[0].options.map((option, index) => 
                                    `<button class="btn" onclick="selectDetectiveOption(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${option}</button>`
                                ).join('')}
                            </div>
                            <div id="detective-score">Score: 0/3</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            window.selectDetectiveOption = function(selectedIndex) {
                const correct = cases[currentCase].correct;
                if (selectedIndex === correct) {
                    score++;
                    showToast('‚úÖ Correct solution!', 'success');
                } else {
                    showToast('‚ùå Wrong approach!', 'error');
                }

                currentCase++;
                if (currentCase < cases.length) {
                    document.querySelector('h4').textContent = `Case ${currentCase + 1}/3`;
                    document.querySelector('#detective-game-content strong').textContent = cases[currentCase].scenario;
                    document.getElementById('detective-options').innerHTML = cases[currentCase].options.map((option, index) => 
                        `<button class="btn" onclick="selectDetectiveOption(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${option}</button>`
                    ).join('');
                    document.getElementById('detective-score').textContent = `Score: ${score}/${currentCase}`;
                } else {
                    // Game finished
                    const finalScore = score;
                    const pointsEarned = Math.floor(finalScore * 20);
                    gameState.points += pointsEarned;
                    updateStats();
                    
                    document.getElementById('detective-game-content').innerHTML = `
                        <div style="text-align: center;">
                            <h3>üéâ All Cases Solved!</h3>
                            <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}/3</div>
                            <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                            <button class="btn" onclick="closeModal()">Close</button>
                        </div>
                    `;
                }
            };
        }

        function playGuardianGame() {
            if (gameState.points < 30) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 30;
            gameState.gamesPlayed++;
            updateStats();
            showGuardianGame();
        }

        function showGuardianGame() {
            const scenarios = [
                {
                    situation: "User wants to vote on a governance proposal privately",
                    options: [
                        "Use public voting",
                        "Use zero-knowledge proof",
                        "Use email verification",
                        "Skip verification"
                    ],
                    correct: 1,
                    explanation: "Zero-knowledge proofs allow proving possession of voting rights without revealing identity"
                },
                {
                    situation: "User wants to make a private transaction",
                    options: [
                        "Use public blockchain",
                        "Use zero-knowledge proof + private execution",
                        "Use centralized exchange",
                        "Use social media"
                    ],
                    correct: 1,
                    explanation: "ZK proofs enable private transactions while maintaining blockchain security"
                },
                {
                    situation: "User wants to prove they own an NFT without showing which one",
                    options: [
                        "Show the NFT publicly",
                        "Use selective disclosure with ZK proof",
                        "Use email verification",
                        "Use social media"
                    ],
                    correct: 1,
                    explanation: "Selective disclosure allows proving ownership without revealing specific details"
                }
            ];

            let currentScenario = 0;
            let score = 0;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üõ°Ô∏è Privacy Guardian Game</h3>
                    <div id="guardian-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Protect user privacy using Anoma's ZK technology</h4>
                            <div style="font-size: 1.2rem; margin: 20px 0; padding: 20px; background: var(--bg); border-radius: 10px;">
                                <strong>Situation:</strong> ${scenarios[0].situation}
                            </div>
                            <div id="guardian-options" style="display: grid; gap: 10px; margin: 20px 0;">
                                ${scenarios[0].options.map((option, index) => 
                                    `<button class="btn" onclick="selectGuardianOption(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${option}</button>`
                                ).join('')}
                            </div>
                            <div id="guardian-score">Score: 0/3</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            window.selectGuardianOption = function(selectedIndex) {
                const correct = scenarios[currentScenario].correct;
                if (selectedIndex === correct) {
                    score++;
                    showToast('‚úÖ Correct privacy solution!', 'success');
                } else {
                    showToast('‚ùå Wrong approach!', 'error');
                }

                currentScenario++;
                if (currentScenario < scenarios.length) {
                    document.querySelector('#guardian-game-content strong').textContent = scenarios[currentScenario].situation;
                    document.getElementById('guardian-options').innerHTML = scenarios[currentScenario].options.map((option, index) => 
                        `<button class="btn" onclick="selectGuardianOption(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${option}</button>`
                    ).join('');
                    document.getElementById('guardian-score').textContent = `Score: ${score}/${currentScenario}`;
                } else {
                    // Game finished
                    const finalScore = score;
                    const pointsEarned = Math.floor(finalScore * 15);
                    gameState.points += pointsEarned;
                    updateStats();
                    
                    document.getElementById('guardian-game-content').innerHTML = `
                        <div style="text-align: center;">
                            <h3>üéâ Game Complete!</h3>
                            <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}/3</div>
                            <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                            <button class="btn" onclick="closeModal()">Close</button>
                        </div>
                    `;
                }
            };
        }

        function playBridgeGame() {
            if (gameState.points < 40) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 40;
            gameState.gamesPlayed++;
            updateStats();
            showBridgeGame();
        }

        function showBridgeGame() {
            const bridges = [
                { from: 'Ethereum', to: 'Polygon', method: 'Polygon Bridge', cost: 0.1, time: 10 },
                { from: 'Ethereum', to: 'Arbitrum', method: 'Arbitrum Bridge', cost: 0.05, time: 5 },
                { from: 'Polygon', to: 'Arbitrum', method: 'Hop Protocol', cost: 0.02, time: 3 },
                { from: 'Arbitrum', to: 'Optimism', method: 'Synapse Protocol', cost: 0.03, time: 4 },
                { from: 'Ethereum', to: 'BSC', method: 'Binance Bridge', cost: 0.08, time: 8 }
            ];

            let currentBridge = 0;
            let score = 0;
            let timeLeft = 60;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üåâ Bridge Master Game</h3>
                    <div id="bridge-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Connect different blockchains efficiently</h4>
                            <div style="font-size: 1.2rem; margin: 20px 0; color: var(--warning);">
                                Time Left: <span id="bridge-time-left">${timeLeft}</span>s
                            </div>
                            <div style="font-size: 1.2rem; margin: 20px 0; padding: 20px; background: var(--bg); border-radius: 10px;">
                                <strong>Bridge from ${bridges[0].from} to ${bridges[0].to}</strong>
                            </div>
                            <div id="bridge-options" style="display: grid; gap: 10px; margin: 20px 0;">
                                ${bridges.map((bridge, index) => 
                                    `<button class="btn" onclick="selectBridge(${index})" style="background: var(--surface); color: var(--text); border: 1px solid var(--border);">${bridge.method} (${bridge.cost} ETH, ${bridge.time}min)</button>`
                                ).join('')}
                            </div>
                            <div id="bridge-score">Score: 0</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Timer
            const timer = setInterval(() => {
                timeLeft--;
                document.getElementById('bridge-time-left').textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    endBridgeGame(score);
                }
            }, 1000);

            window.selectBridge = function(bridgeIndex) {
                const selectedBridge = bridges[bridgeIndex];
                const currentTarget = bridges[currentBridge];
                
                if (selectedBridge.from === currentTarget.from && selectedBridge.to === currentTarget.to) {
                    score++;
                    currentBridge = (currentBridge + 1) % bridges.length;
                    document.querySelector('#bridge-game-content strong').textContent = `Bridge from ${bridges[currentBridge].from} to ${bridges[currentBridge].to}`;
                    document.getElementById('bridge-score').textContent = `Score: ${score}`;
                    showToast('‚úÖ Correct bridge!', 'success');
                } else {
                    showToast('‚ùå Wrong bridge!', 'error');
                }
            };

            function endBridgeGame(finalScore) {
                clearInterval(timer);
                const pointsEarned = Math.floor(finalScore * 25);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('bridge-game-content').innerHTML = `
                    <div style="text-align: center;">
                        <h3>üéâ Game Complete!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                        <button class="btn" onclick="closeModal()">Close</button>
                    </div>
                `;
            }
        }

        function playBuilderGame() {
            if (gameState.points < 50) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 50;
            gameState.gamesPlayed++;
            updateStats();
            showBuilderGame();
        }

        function showBuilderGame() {
            const components = [
                { type: 'action', text: 'Swap', cost: 10 },
                { type: 'action', text: 'Bridge', cost: 15 },
                { type: 'action', text: 'Vote', cost: 5 },
                { type: 'action', text: 'Stake', cost: 20 },
                { type: 'token', text: 'ETH', cost: 5 },
                { type: 'token', text: 'USDC', cost: 5 },
                { type: 'token', text: 'USDT', cost: 5 },
                { type: 'amount', text: '1', cost: 2 },
                { type: 'amount', text: '100', cost: 2 },
                { type: 'amount', text: '1000', cost: 2 },
                { type: 'chain', text: 'Ethereum', cost: 8 },
                { type: 'chain', text: 'Polygon', cost: 8 },
                { type: 'chain', text: 'Arbitrum', cost: 8 }
            ];

            let budget = 50;
            let selectedComponents = [];
            let score = 0;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="width: 90%; max-width: 800px;">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üéØ Intent Builder Game</h3>
                    <div id="builder-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Build complex intents with limited budget</h4>
                            <div style="display: flex; justify-content: space-between; margin: 20px 0;">
                                <div>Budget: <span id="budget">${budget}</span> points</div>
                                <div>Score: <span id="builder-score">${score}</span></div>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                                <div>
                                    <h5>Available Components:</h5>
                                    <div id="components-list" style="display: grid; gap: 5px; max-height: 300px; overflow-y: auto;">
                                        ${components.map((comp, index) => 
                                            `<button class="btn" onclick="addComponent(${index})" style="font-size: 0.9rem; padding: 8px 12px; background: var(--surface); color: var(--text); border: 1px solid var(--border);">${comp.text} (${comp.cost})</button>`
                                        ).join('')}
                                    </div>
                                </div>
                                <div>
                                    <h5>Your Intent:</h5>
                                    <div id="intent-display" style="min-height: 200px; background: var(--bg); border: 2px solid var(--border); border-radius: 10px; padding: 15px; margin: 10px 0;">
                                        <div style="color: var(--muted); text-align: center;">No components selected</div>
                                    </div>
                                    <div style="margin: 10px 0;">
                                        <button class="btn" onclick="buildIntent()" style="background: var(--success);">Build Intent</button>
                                        <button class="btn" onclick="clearIntent()" style="background: var(--danger);">Clear</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            window.addComponent = function(index) {
                const component = components[index];
                if (budget >= component.cost) {
                    budget -= component.cost;
                    selectedComponents.push(component);
                    updateDisplay();
                } else {
                    showToast('Not enough budget!', 'error');
                }
            };

            window.buildIntent = function() {
                if (selectedComponents.length === 0) {
                    showToast('Select at least one component!', 'error');
                    return;
                }

                const intent = buildIntentText(selectedComponents);
                const points = calculateIntentScore(selectedComponents);
                score += points;
                
                showToast(`Intent built! +${points} points`, 'success');
                
                // Reset for next round
                budget = 50;
                selectedComponents = [];
                updateDisplay();
            };

            window.clearIntent = function() {
                budget = 50;
                selectedComponents = [];
                updateDisplay();
            };

            function updateDisplay() {
                document.getElementById('budget').textContent = budget;
                document.getElementById('builder-score').textContent = score;
                
                const intentDisplay = document.getElementById('intent-display');
                if (selectedComponents.length === 0) {
                    intentDisplay.innerHTML = '<div style="color: var(--muted); text-align: center;">No components selected</div>';
                } else {
                    intentDisplay.innerHTML = selectedComponents.map(comp => 
                        `<span style="background: var(--accent); color: white; padding: 4px 8px; border-radius: 4px; margin: 2px; display: inline-block;">${comp.text}</span>`
                    ).join('');
                }
            }

            function buildIntentText(components) {
                const actions = components.filter(c => c.type === 'action');
                const tokens = components.filter(c => c.type === 'token');
                const amounts = components.filter(c => c.type === 'amount');
                const chains = components.filter(c => c.type === 'chain');
                
                let intent = 'I want to ';
                if (actions.length > 0) {
                    intent += actions.map(a => a.text.toLowerCase()).join(' and ');
                }
                if (amounts.length > 0 && tokens.length > 0) {
                    intent += ` ${amounts[0].text} ${tokens[0].text}`;
                }
                if (chains.length > 0) {
                    intent += ` on ${chains[0].text}`;
                }
                
                return intent;
            }

            function calculateIntentScore(components) {
                let score = 0;
                const types = components.map(c => c.type);
                
                // Base score for each component
                score += components.length * 5;
                
                // Bonus for combinations
                if (types.includes('action') && types.includes('token')) score += 20;
                if (types.includes('action') && types.includes('chain')) score += 15;
                if (types.includes('amount') && types.includes('token')) score += 10;
                
                // Bonus for multiple actions
                const actionCount = types.filter(t => t === 'action').length;
                if (actionCount > 1) score += actionCount * 10;
                
                return score;
            }
        }

        function playTowerDefense() {
            if (gameState.points < 60) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 60;
            gameState.gamesPlayed++;
            updateStats();
            showTowerDefense();
        }

        function showTowerDefense() {
            let wave = 1;
            let score = 100;
            let health = 100;
            let towers = [];
            let enemies = [];
            let gameRunning = false;

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="width: 90%; max-width: 800px;">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üéÆ Intent Tower Defense</h3>
                    <div id="tower-defense-content">
                        <div style="display: flex; justify-content: space-between; margin: 20px 0;">
                            <div>Wave: <span id="wave">${wave}</span></div>
                            <div>Health: <span id="health">${health}</span></div>
                            <div>Score: <span id="score">${score}</span></div>
                        </div>
                        <div id="game-board" style="width: 100%; height: 400px; background: linear-gradient(45deg, #1a1a2e, #16213e); border: 2px solid var(--border); border-radius: 10px; position: relative; overflow: hidden;">
                            <div id="path" style="position: absolute; top: 50%; left: 0; width: 100%; height: 20px; background: rgba(255, 255, 255, 0.3); transform: translateY(-50%);"></div>
                        </div>
                        <div style="margin: 20px 0;">
                            <h4>Defense Tools (Click to place):</h4>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn" onclick="placeTower('ZK-Proof')" style="background: var(--success);">üõ°Ô∏è ZK-Proof (20 points)</button>
                                <button class="btn" onclick="placeTower('Intent-Solver')" style="background: var(--accent);">‚ö° Intent Solver (30 points)</button>
                                <button class="btn" onclick="placeTower('Privacy-Guard')" style="background: var(--warning);">üîê Privacy Guard (25 points)</button>
                                <button class="btn" onclick="placeTower('Cross-Chain')" style="background: var(--danger);">üåâ Cross-Chain (35 points)</button>
                            </div>
                        </div>
                        <div style="margin: 20px 0;">
                            <button class="btn" onclick="startWave()" id="wave-btn">Start Wave ${wave}</button>
                            <button class="btn" onclick="pauseGame()" id="pause-btn">Pause</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            let gameInterval;
            let enemyInterval;

            window.placeTower = function(type) {
                if (score < getTowerCost(type)) {
                    showToast('Not enough points!', 'error');
                    return;
                }
                
                const tower = {
                    type: type,
                    x: Math.random() * 700 + 50,
                    y: Math.random() * 300 + 50,
                    cost: getTowerCost(type),
                    damage: getTowerDamage(type),
                    range: getTowerRange(type)
                };
                
                towers.push(tower);
                score -= tower.cost;
                updateTowerDefenseDisplay();
                renderTowers();
            };

            window.startWave = function() {
                if (!gameRunning) {
                    gameRunning = true;
                    startGameLoop();
                    console.log('Game loop started');
                }
                
                spawnEnemies();
                document.getElementById('wave-btn').disabled = true;
                console.log(`Wave ${wave} started with ${wave * 3} enemies`);
            };

            window.pauseGame = function() {
                gameRunning = !gameRunning;
                document.getElementById('pause-btn').textContent = gameRunning ? 'Pause' : 'Resume';
            };

            function getTowerCost(type) {
                const costs = { 'ZK-Proof': 20, 'Intent-Solver': 30, 'Privacy-Guard': 25, 'Cross-Chain': 35 };
                return costs[type] || 20;
            }

            function getTowerDamage(type) {
                const damages = { 'ZK-Proof': 15, 'Intent-Solver': 25, 'Privacy-Guard': 20, 'Cross-Chain': 30 };
                return damages[type] || 15;
            }

            function getTowerRange(type) {
                const ranges = { 'ZK-Proof': 80, 'Intent-Solver': 100, 'Privacy-Guard': 70, 'Cross-Chain': 90 };
                return ranges[type] || 80;
            }

            function spawnEnemies() {
                const enemyTypes = ['Malicious Intent', 'Privacy Breach', 'MEV Attack', 'Front-running'];
                const enemyCount = wave * 3;
                console.log(`Spawning ${enemyCount} enemies for wave ${wave}`);
                
                for (let i = 0; i < enemyCount; i++) {
                    setTimeout(() => {
                        const enemy = {
                            type: enemyTypes[Math.floor(Math.random() * enemyTypes.length)],
                            x: -50, // Start off-screen
                            y: 200,
                            health: 50 + wave * 10,
                            maxHealth: 50 + wave * 10,
                            speed: 1 + wave * 0.2,
                            reward: 10 + wave * 5,
                            id: Date.now() + Math.random() // Unique ID
                        };
                        enemies.push(enemy);
                        console.log(`Enemy spawned: ${enemy.type} at x=${enemy.x}`);
                    }, i * 800); // Faster spawning
                }
            }

            function startGameLoop() {
                gameInterval = setInterval(() => {
                    if (!gameRunning) return;
                    
                    // Move enemies
                    enemies.forEach((enemy, index) => {
                        enemy.x += enemy.speed;
                        console.log(`Enemy ${enemy.type} at x=${enemy.x}, speed=${enemy.speed}`);
                        
                        if (enemy.x > 800) {
                            health -= 10;
                            enemies.splice(index, 1);
                            console.log(`Enemy reached end! Health: ${health}`);
                            if (health <= 0) {
                                endTowerDefense();
                            }
                        }
                    });

                    // Tower attacks
                    towers.forEach(tower => {
                        enemies.forEach(enemy => {
                            const distance = Math.sqrt(Math.pow(tower.x - enemy.x, 2) + Math.pow(tower.y - enemy.y, 2));
                            if (distance <= tower.range) {
                                enemy.health -= tower.damage;
                                if (enemy.health <= 0) {
                                    score += enemy.reward;
                                    enemies.splice(enemies.indexOf(enemy), 1);
                                    console.log(`Enemy killed! Score: ${score}`);
                                }
                            }
                        });
                    });

                    updateTowerDefenseDisplay();
                    renderTowers();
                    
                    // Check wave complete
                    if (enemies.length === 0 && wave < 5) {
                        wave++;
                        document.getElementById('wave-btn').disabled = false;
                        document.getElementById('wave-btn').textContent = `Start Wave ${wave}`;
                        console.log(`Wave ${wave} complete! Starting wave ${wave + 1}`);
                    } else if (wave >= 5) {
                        endTowerDefense();
                    }
                }, 50); // Faster game loop
            }

            function renderTowers() {
                const board = document.getElementById('game-board');
                board.innerHTML = '<div id="path" style="position: absolute; top: 50%; left: 0; width: 100%; height: 20px; background: rgba(255, 255, 255, 0.3); transform: translateY(-50%);"></div>';
                
                towers.forEach(tower => {
                    const towerEl = document.createElement('div');
                    towerEl.style.position = 'absolute';
                    towerEl.style.left = tower.x + 'px';
                    towerEl.style.top = tower.y + 'px';
                    towerEl.style.width = '30px';
                    towerEl.style.height = '30px';
                    towerEl.style.borderRadius = '50%';
                    towerEl.style.display = 'flex';
                    towerEl.style.alignItems = 'center';
                    towerEl.style.justifyContent = 'center';
                    towerEl.style.fontSize = '16px';
                    towerEl.style.cursor = 'pointer';
                    towerEl.onclick = () => upgradeTower(tower);
                    
                    const icons = { 'ZK-Proof': 'üõ°Ô∏è', 'Intent-Solver': '‚ö°', 'Privacy-Guard': 'üîê', 'Cross-Chain': 'üåâ' };
                    towerEl.textContent = icons[tower.type];
                    towerEl.style.background = getTowerColor(tower.type);
                    board.appendChild(towerEl);
                });

                // Render enemies
                enemies.forEach(enemy => {
                    const enemyEl = document.createElement('div');
                    enemyEl.style.position = 'absolute';
                    enemyEl.style.left = enemy.x + 'px';
                    enemyEl.style.top = enemy.y + 'px';
                    enemyEl.style.width = '30px';
                    enemyEl.style.height = '30px';
                    enemyEl.style.background = 'var(--danger)';
                    enemyEl.style.borderRadius = '5px';
                    enemyEl.style.fontSize = '16px';
                    enemyEl.style.display = 'flex';
                    enemyEl.style.alignItems = 'center';
                    enemyEl.style.justifyContent = 'center';
                    enemyEl.style.zIndex = '8';
                    enemyEl.style.border = '2px solid #ff4444';
                    
                    // Different enemy types
                    const enemyIcons = {
                        'Malicious Intent': 'üëπ',
                        'Privacy Breach': 'üîì',
                        'MEV Attack': '‚ö°',
                        'Front-running': 'üèÉ'
                    };
                    enemyEl.textContent = enemyIcons[enemy.type] || 'üëπ';
                    
                    // Health bar
                    const healthBar = document.createElement('div');
                    healthBar.style.position = 'absolute';
                    healthBar.style.top = '-8px';
                    healthBar.style.left = '0px';
                    healthBar.style.width = '30px';
                    healthBar.style.height = '4px';
                    healthBar.style.background = 'var(--danger)';
                    healthBar.style.borderRadius = '2px';
                    
                    const healthFill = document.createElement('div');
                    healthFill.style.width = `${(enemy.health / enemy.maxHealth) * 100}%`;
                    healthFill.style.height = '100%';
                    healthFill.style.background = 'var(--success)';
                    healthFill.style.borderRadius = '2px';
                    healthBar.appendChild(healthFill);
                    
                    enemyEl.appendChild(healthBar);
                    board.appendChild(enemyEl);
                });
            }

            function getTowerColor(type) {
                const colors = { 'ZK-Proof': 'var(--success)', 'Intent-Solver': 'var(--accent)', 'Privacy-Guard': 'var(--warning)', 'Cross-Chain': 'var(--danger)' };
                return colors[type] || 'var(--surface)';
            }

            function updateTowerDefenseDisplay() {
                document.getElementById('wave').textContent = wave;
                document.getElementById('health').textContent = health;
                document.getElementById('score').textContent = score;
            }

            function upgradeTower(tower) {
                if (score >= tower.cost) {
                    tower.damage += 5;
                    tower.range += 10;
                    score -= tower.cost;
                    updateTowerDefenseDisplay();
                    renderTowers();
                    showToast('Tower upgraded!', 'success');
                } else {
                    showToast('Not enough points to upgrade!', 'error');
                }
            }

            function endTowerDefense() {
                clearInterval(gameInterval);
                const pointsEarned = Math.floor(score / 2);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('tower-defense-content').innerHTML = `
                    <div style="text-align: center;">
                        <h3>üéâ Game Complete!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${score}</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                        <button class="btn" onclick="closeModal()">Close</button>
                    </div>
                `;
            }
        }

        function playPuzzleGame() {
            if (gameState.points < 35) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 35;
            gameState.gamesPlayed++;
            updateStats();
            showPuzzleGame();
        }

        function showPuzzleGame() {
            const puzzlePieces = [
                { id: 1, text: 'Generate Proof', type: 'step', order: 1 },
                { id: 2, text: 'Verify Identity', type: 'step', order: 2 },
                { id: 3, text: 'Submit Transaction', type: 'step', order: 3 },
                { id: 4, text: 'Validate on Chain', type: 'step', order: 4 },
                { id: 5, text: 'Privacy Preserved', type: 'result', order: 5 }
            ];

            let score = 0;
            let timeLeft = 60;
            let currentPuzzle = 0;
            let selectedPieces = [];

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="width: 90%; max-width: 700px;">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üß© Privacy Puzzle Game</h3>
                    <div id="puzzle-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Arrange ZK-Proof flow correctly</h4>
                            <div style="display: flex; justify-content: space-between; margin: 20px 0;">
                                <div>Time Left: <span id="puzzle-time">${timeLeft}</span>s</div>
                                <div>Score: <span id="puzzle-score">${score}</span></div>
                            </div>
                            <div style="background: var(--bg); border: 2px solid var(--border); border-radius: 10px; padding: 20px; margin: 20px 0;">
                                <h5>Drop pieces here in correct order:</h5>
                                <div id="puzzle-area" style="min-height: 200px; border: 2px dashed var(--border); border-radius: 5px; padding: 10px; display: flex; flex-direction: column; gap: 5px;">
                                    <div style="color: var(--muted); text-align: center;">Drag pieces here</div>
                                </div>
                            </div>
                            <div style="background: var(--surface); border: 2px solid var(--border); border-radius: 10px; padding: 20px; margin: 20px 0;">
                                <h5>Available pieces:</h5>
                                <div id="pieces-container" style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                                    ${puzzlePieces.map(piece => 
                                        `<div class="puzzle-piece" data-id="${piece.id}" data-order="${piece.order}" style="background: var(--accent); color: white; padding: 10px 15px; border-radius: 5px; cursor: grab; user-select: none;">${piece.text}</div>`
                                    ).join('')}
                                </div>
                            </div>
                            <div style="margin: 20px 0;">
                                <button class="btn" onclick="checkPuzzle()" style="background: var(--success);">Check Solution</button>
                                <button class="btn" onclick="resetPuzzle()" style="background: var(--warning);">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Timer
            const timer = setInterval(() => {
                timeLeft--;
                document.getElementById('puzzle-time').textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    endPuzzleGame(score);
                }
            }, 1000);

            // Make pieces draggable
            const pieces = document.querySelectorAll('.puzzle-piece');
            pieces.forEach(piece => {
                piece.draggable = true;
                piece.addEventListener('dragstart', handleDragStart);
            });

            const puzzleArea = document.getElementById('puzzle-area');
            puzzleArea.addEventListener('dragover', handleDragOver);
            puzzleArea.addEventListener('drop', handleDrop);

            let draggedPiece = null;

            function handleDragStart(e) {
                draggedPiece = e.target;
                e.target.style.opacity = '0.5';
            }

            function handleDragOver(e) {
                e.preventDefault();
            }

            function handleDrop(e) {
                e.preventDefault();
                if (draggedPiece) {
                    const piece = {
                        id: parseInt(draggedPiece.dataset.id),
                        text: draggedPiece.textContent,
                        order: parseInt(draggedPiece.dataset.order)
                    };
                    
                    if (!selectedPieces.find(p => p.id === piece.id)) {
                        selectedPieces.push(piece);
                        renderPuzzleArea();
                        draggedPiece.style.display = 'none';
                    }
                    draggedPiece.style.opacity = '1';
                    draggedPiece = null;
                }
            }

            function renderPuzzleArea() {
                const area = document.getElementById('puzzle-area');
                if (selectedPieces.length === 0) {
                    area.innerHTML = '<div style="color: var(--muted); text-align: center;">Drag pieces here</div>';
                } else {
                    area.innerHTML = selectedPieces.map((piece, index) => 
                        `<div style="background: var(--accent); color: white; padding: 8px 12px; border-radius: 4px; margin: 2px; display: inline-block; cursor: pointer;" onclick="removePiece(${piece.id})">${index + 1}. ${piece.text}</div>`
                    ).join('');
                }
            }

            window.removePiece = function(id) {
                selectedPieces = selectedPieces.filter(p => p.id !== id);
                renderPuzzleArea();
                
                // Show the piece again
                const piece = document.querySelector(`[data-id="${id}"]`);
                if (piece) {
                    piece.style.display = 'block';
                }
            };

            window.checkPuzzle = function() {
                if (selectedPieces.length !== puzzlePieces.length) {
                    showToast('Complete the puzzle first!', 'error');
                    return;
                }

                let correct = 0;
                selectedPieces.forEach((piece, index) => {
                    if (piece.order === index + 1) {
                        correct++;
                    }
                });

                const points = Math.floor((correct / puzzlePieces.length) * 100);
                score += points;
                document.getElementById('puzzle-score').textContent = score;

                if (correct === puzzlePieces.length) {
                    showToast('üéâ Perfect! Puzzle solved!', 'success');
                    setTimeout(() => {
                        resetPuzzle();
                    }, 2000);
                } else {
                    showToast(`‚úÖ ${correct}/${puzzlePieces.length} correct! Try again!`, 'warning');
                }
            };

            window.resetPuzzle = function() {
                selectedPieces = [];
                renderPuzzleArea();
                
                // Show all pieces again
                pieces.forEach(piece => {
                    piece.style.display = 'block';
                });
            };

            function endPuzzleGame(finalScore) {
                clearInterval(timer);
                const pointsEarned = Math.floor(finalScore / 10);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('puzzle-game-content').innerHTML = `
                    <div style="text-align: center;">
                        <h3>üéâ Game Complete!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${finalScore}</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                        <button class="btn" onclick="closeModal()">Close</button>
                    </div>
                `;
            }
        }

        function playRunnerGame() {
            if (gameState.points < 30) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 30;
            gameState.gamesPlayed++;
            updateStats();
            showSimpleRunnerGame();
        }

        function showSimpleRunnerGame() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="width: 90%; max-width: 600px;">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üèÉ Intent Runner</h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; margin: 20px 0;">
                            <div>Score: <span id="runner-score">0</span></div>
                            <div>Status: <span id="jump-status">Ready</span></div>
                        </div>
                        <div id="runner-board" style="width: 100%; height: 300px; background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%); border: 2px solid var(--border); border-radius: 10px; position: relative; overflow: hidden;">
                            <div id="runner-player" style="position: absolute; left: 50px; top: 250px; width: 30px; height: 30px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; z-index: 10;">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div style="margin: 20px 0;">
                            <p><strong>Controls:</strong> Press SPACE to jump!</p>
                            <p><strong>Goal:</strong> Avoid obstacles üö´ and collect diamonds üíé!</p>
                        </div>
                        <div style="margin: 20px 0;">
                            <button class="btn" onclick="startSimpleRunner()" id="start-runner-btn">Start Game</button>
                            <button class="btn" onclick="closeModal()">Close</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Game state variables
            let isJumping = false;
            let gameRunning = false;
            let score = 0;
            let obstacles = [];
            let collectibles = [];
            let gameInterval;
            let obstacleInterval;
            let playerY = 250; // Track player Y position
            let jumpHeight = 0;
            let jumpSpeed = 0;
            let gravity = 0.8;
            let jumpPower = 15;

            // Global jump handler - ALWAYS active
            function globalJumpHandler(e) {
                if (e.code === 'Space') {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Space pressed! Game running:', gameRunning, 'Is jumping:', isJumping);
                    if (gameRunning && !isJumping && playerY >= 250) {
                        jump();
                    }
                }
            }

            // Remove any existing listeners and add new one
            document.removeEventListener('keydown', globalJumpHandler);
            document.addEventListener('keydown', globalJumpHandler);

            function startSimpleRunner() {
                console.log('Starting game...');
                gameRunning = true;
                score = 0;
                isJumping = false;
                obstacles = [];
                collectibles = [];
                playerY = 250;
                jumpHeight = 0;
                jumpSpeed = 0;
                
                document.getElementById('start-runner-btn').disabled = true;
                document.getElementById('jump-status').textContent = 'Ready';
                
                // Start game loop
                gameInterval = setInterval(() => {
                    if (!gameRunning) return;
                    updateGame();
                    renderGame();
                }, 16); // 60 FPS
                
                // Start spawning obstacles
                obstacleInterval = setInterval(() => {
                    if (!gameRunning) return;
                    spawnObstacle();
                    if (Math.random() < 0.3) {
                        spawnCollectible();
                    }
                }, 1500);

                showToast('Game started! Press SPACE to jump!', 'success');
            }

            function spawnObstacle() {
                obstacles.push({
                    x: 600,
                    height: 40 + Math.random() * 40,
                    type: 'üö´'
                });
            }

            function spawnCollectible() {
                collectibles.push({
                    x: 600,
                    y: 200 + Math.random() * 50
                });
            }

            function updateGame() {
                // Update jump physics
                if (isJumping) {
                    jumpSpeed -= gravity;
                    jumpHeight += jumpSpeed;
                    
                    if (jumpHeight <= 0) {
                        jumpHeight = 0;
                        jumpSpeed = 0;
                        isJumping = false;
                        playerY = 250;
                        document.getElementById('jump-status').textContent = 'Ready';
                    } else {
                        playerY = 250 - jumpHeight;
                    }
                }

                // Move obstacles
                obstacles.forEach((obstacle, index) => {
                    obstacle.x -= 3;
                    if (obstacle.x < -50) {
                        obstacles.splice(index, 1);
                        score += 10;
                    }
                });

                // Move collectibles
                collectibles.forEach((collectible, index) => {
                    collectible.x -= 3;
                    if (collectible.x < -50) {
                        collectibles.splice(index, 1);
                    }
                });

                // Check collisions
                checkCollisions();
            }

            function checkCollisions() {
                const playerX = 50;
                const playerWidth = 30;
                const playerHeight = 30;

                // Check obstacle collisions
                obstacles.forEach((obstacle, index) => {
                    const obstacleX = obstacle.x;
                    const obstacleY = 300 - obstacle.height;
                    const obstacleWidth = 30;
                    const obstacleHeight = obstacle.height;

                    if (playerX < obstacleX + obstacleWidth &&
                        playerX + playerWidth > obstacleX &&
                        playerY + playerHeight > obstacleY) {
                        // Collision detected
                        endGame();
                        return;
                    }
                });

                // Check collectible collisions
                collectibles.forEach((collectible, index) => {
                    const itemX = collectible.x;
                    const itemY = collectible.y;
                    const itemSize = 20;

                    if (playerX < itemX + itemSize &&
                        playerX + playerWidth > itemX &&
                        playerY < itemY + itemSize &&
                        playerY + playerHeight > itemY) {
                        // Item collected
                        collectibles.splice(index, 1);
                        score += 50;
                        showToast('üíé Diamond collected!', 'success');
                    }
                });
            }

            function renderGame() {
                const board = document.getElementById('runner-board');
                board.innerHTML = `
                    <div id="runner-player" style="position: absolute; left: 50px; top: ${playerY}px; width: 30px; height: 30px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; z-index: 10;">üßô‚Äç‚ôÇÔ∏è</div>
                `;

                // Render ground
                const ground = document.createElement('div');
                ground.style.position = 'absolute';
                ground.style.left = '0px';
                ground.style.top = '250px';
                ground.style.width = '100%';
                ground.style.height = '50px';
                ground.style.background = 'var(--surface)';
                ground.style.borderTop = '2px solid var(--accent)';
                ground.style.zIndex = '1';
                board.appendChild(ground);

                // Render obstacles
                obstacles.forEach(obstacle => {
                    const obstacleEl = document.createElement('div');
                    obstacleEl.style.position = 'absolute';
                    obstacleEl.style.left = obstacle.x + 'px';
                    obstacleEl.style.top = (300 - obstacle.height) + 'px';
                    obstacleEl.style.width = '30px';
                    obstacleEl.style.height = obstacle.height + 'px';
                    obstacleEl.style.background = 'var(--danger)';
                    obstacleEl.style.borderRadius = '5px';
                    obstacleEl.style.display = 'flex';
                    obstacleEl.style.alignItems = 'center';
                    obstacleEl.style.justifyContent = 'center';
                    obstacleEl.style.fontSize = '16px';
                    obstacleEl.style.zIndex = '5';
                    obstacleEl.textContent = obstacle.type;
                    board.appendChild(obstacleEl);
                });

                // Render collectibles
                collectibles.forEach(collectible => {
                    const collectibleEl = document.createElement('div');
                    collectibleEl.style.position = 'absolute';
                    collectibleEl.style.left = collectible.x + 'px';
                    collectibleEl.style.top = collectible.y + 'px';
                    collectibleEl.style.width = '20px';
                    collectibleEl.style.height = '20px';
                    collectibleEl.style.background = 'var(--success)';
                    collectibleEl.style.borderRadius = '50%';
                    collectibleEl.style.display = 'flex';
                    collectibleEl.style.alignItems = 'center';
                    collectibleEl.style.justifyContent = 'center';
                    collectibleEl.style.fontSize = '12px';
                    collectibleEl.style.zIndex = '5';
                    collectibleEl.textContent = 'üíé';
                    board.appendChild(collectibleEl);
                });

                // Update score
                document.getElementById('runner-score').textContent = score;
            }

            function jump() {
                console.log('Jump function called!');
                if (isJumping || !gameRunning) {
                    console.log('Jump blocked - isJumping:', isJumping, 'gameRunning:', gameRunning);
                    return;
                }
                
                isJumping = true;
                jumpSpeed = jumpPower;
                jumpHeight = 0;
                document.getElementById('jump-status').textContent = 'Jumping!';
                console.log('Jump started!');
            }

            function endGame() {
                gameRunning = false;
                clearInterval(gameInterval);
                clearInterval(obstacleInterval);
                
                const pointsEarned = Math.floor(score / 10);
                gameState.points += pointsEarned;
                updateStats();
                
                document.getElementById('runner-board').innerHTML = `
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: white;">
                        <h3>üéâ Game Over!</h3>
                        <div style="font-size: 2rem; margin: 20px 0;">Final Score: ${score}</div>
                        <div style="font-size: 1.2rem; margin: 20px 0;">Points Earned: ${pointsEarned}</div>
                    </div>
                `;
            }

            window.startSimpleRunner = startSimpleRunner;
        }

        function playDiceGame() {
            if (gameState.points < 25) {
                showToast('Not enough points!', 'error');
                return;
            }
            gameState.points -= 25;
            gameState.gamesPlayed++;
            updateStats();
            showDiceGame();
        }

        function showComingSoon() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="text-align: center; max-width: 500px;">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <div style="font-size: 4rem; margin: 20px 0;">üöÄ</div>
                    <h2>More Games Coming Soon!</h2>
                    <h3>Êõ¥Â§öÊ∏∏ÊàèÊï¨ËØ∑ÊúüÂæÖÔºÅ</h3>
                    <div style="margin: 30px 0; padding: 20px; background: var(--surface); border-radius: 10px;">
                        <h4>üéÆ Upcoming Games:</h4>
                        <ul style="text-align: left; margin: 20px 0;">
                            <li>üéØ Intent Battle Royale</li>
                            <li>üèÜ Anoma Racing Championship</li>
                            <li>üß† Memory Challenge</li>
                            <li>üé™ Intent Carnival</li>
                            <li>‚öîÔ∏è Privacy Wars</li>
                            <li>üé® Intent Art Studio</li>
                        </ul>
                    </div>
                    <p style="color: var(--muted); margin: 20px 0;">
                        We're working hard to bring you more exciting games that teach Anoma concepts!
                    </p>
                    <button class="btn" onclick="closeModal()" style="background: var(--accent);">Got it!</button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showDiceGame() {
            let score = 0;
            let rolls = 0;
            let maxRolls = 10;
            let dice = [0, 0, 0, 0, 0];

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                    <h3>üé≤ Intent Dice Game</h3>
                    <div id="dice-game-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <h4>Roll dice to build the best intent combinations</h4>
                            <div style="display: flex; justify-content: space-between; margin: 20px 0;">
                                <div>Score: <span id="dice-score">${score}</span></div>
                                <div>Rolls Left: <span id="rolls-left">${maxRolls - rolls}</span></div>
                            </div>
                            <div id="dice-container" style="display: flex; justify-content: center; gap: 10px; margin: 20px 0;">
                                ${dice.map((value, index) => 
                                    `<div class="dice" onclick="holdDice(${index})" style="width: 60px; height: 60px; background: var(--surface); border: 2px solid var(--border); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; transition: all 0.3s ease;">${value || '?'}</div>`
                                ).join('')}
                            </div>
                            <div style="margin: 20px 0;">
                                <button class="btn" onclick="rollDice()" id="roll-btn">Roll Dice</button>
                                <button class="btn" onclick="scoreDice()" id="score-btn" disabled>Score Intent</button>
                            </div>
                            <div id="dice-combinations" style="margin: 20px 0;">
                                <h5>Available Intent Combinations:</h5>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; text-align: left;">
                                    <div>Swap + Token = 50 points</div>
                                    <div>Bridge + Chain = 40 points</div>
                                    <div>Vote + Privacy = 60 points</div>
                                    <div>Stake + Yield = 70 points</div>
                                    <div>Three of a kind = 30 points</div>
                                    <div>Full house = 100 points</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            const intentTypes = ['Swap', 'Bridge', 'Vote', 'Stake', 'Token', 'Chain', 'Privacy', 'Yield'];

            function updateDiceDisplay() {
                document.getElementById('dice-score').textContent = score;
                document.getElementById('rolls-left').textContent = maxRolls - rolls;
                
                dice.forEach((value, index) => {
                    const diceEl = document.querySelector(`.dice:nth-child(${index + 1})`);
                    if (diceEl) {
                        diceEl.textContent = value || '?';
                    }
                });
            }

            window.rollDice = function() {
                if (rolls >= maxRolls) return;
                
                dice = dice.map((value, index) => {
                    const diceEl = document.querySelector(`.dice:nth-child(${index + 1})`);
                    if (!diceEl.classList.contains('held')) {
                        return Math.floor(Math.random() * 8);
                    }
                    return value;
                });
                
                rolls++;
                updateDiceDisplay();
                
                if (rolls >= maxRolls) {
                    document.getElementById('roll-btn').disabled = true;
                }
                document.getElementById('score-btn').disabled = false;
            };

            window.holdDice = function(index) {
                const diceEl = document.querySelector(`.dice:nth-child(${index + 1})`);
                diceEl.classList.toggle('held');
                diceEl.style.background = diceEl.classList.contains('held') ? 'var(--accent)' : 'var(--surface)';
            };

            window.scoreDice = function() {
                const points = calculateScore();
                score += points;
                showToast(`Intent scored! +${points} points`, 'success');
                
                dice = [0, 0, 0, 0, 0];
                rolls = 0;
                
                document.querySelectorAll('.dice').forEach(el => {
                    el.classList.remove('held');
                    el.style.background = 'var(--surface)';
                });
                
                document.getElementById('roll-btn').disabled = false;
                document.getElementById('score-btn').disabled = true;
                updateDiceDisplay();
            };

            function calculateScore() {
                const types = dice.map(value => intentTypes[value]);
                
                // Check for specific combinations
                if (types.includes('Swap') && types.includes('Token')) return 50;
                if (types.includes('Bridge') && types.includes('Chain')) return 40;
                if (types.includes('Vote') && types.includes('Privacy')) return 60;
                if (types.includes('Stake') && types.includes('Yield')) return 70;
                
                // Check for dice combinations
                const counts = {};
                types.forEach(type => counts[type] = (counts[type] || 0) + 1);
                const values = Object.values(counts).sort((a, b) => b - a);
                
                if (values[0] === 5) return 200; // Five of a kind
                if (values[0] === 4) return 150; // Four of a kind
                if (values[0] === 3 && values[1] === 2) return 100; // Full house
                if (values[0] === 3) return 30; // Three of a kind
                if (values[0] === 2) return 10; // Pair
                
                return 0;
            }
        }

        // Close modal
        function closeModal() {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => modal.remove());
        }

        // Show toast
        function showToast(message, type) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }
    </script>
</body>
</html>
